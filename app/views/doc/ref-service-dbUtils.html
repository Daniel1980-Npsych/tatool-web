<h2>dbUtils</h2>

<p>The dbUtils service offers methods that allow you to interact with the Tatool database. The most common methods are used to save and access Module/Session Properties and Trials.
</p>

<ul id="docPageNav">
  <li><i class="fa fa-angle-right"></i> <a href ng-click="scrollTo('property')">Property Methods</a></li>
  <li><i class="fa fa-angle-right"></i> <a href ng-click="scrollTo('trial')">Trial Methods</a></li>
</ul>

<hr class="hr-red">

<h4 id="property">Property Methods<span class="pull-right"><a href ng-click="scrollTo('top')"><i class="fa fa-caret-up fa-lg"></i></a></span></h4>

<p><b>When to use Module/Session Properties?</b><br>
Module Properties should be used to store values that are unique to a Module. Session Properties should be used to store values that are unique to a Session.</p>
<hr>

<p><b class="red">setModuleProperty(element, propertyKey, propertyValue)</b> - (no return value)</p>
<p>Used to store unique string values on module level in order to allow access from different parts of the Module or to save values that can be used over multiple sessions (e.g. set the current level to the last level achieved in a specific task in the previous session at the beginning of a new session).</p>

<p><b>Parameters</b><br>
<i>element</i>: the object this property belongs to. Usually the Executable or Handler object storing the property<br>
<i>propertyKey</i>: the key of the property (string)<br>
<i>propertyValue</i>: the value of the property (string)
</p>

<pre><code class="language-javascript">// store the current level as a Module Property with the name currentLevel of this Executable
dbUtils.setModuleProperty(this, 'currentLevel', 4);
</code></pre>

<hr>

<p><b class="red">getModuleProperty(element, propertyKey)</b> - returns the module property value as a string</p>
<p>Used to access a Module Property of a specific element.</p>

<p><b>Parameters</b><br>
<i>element</i>: the object this property belongs to. Usually the Executable or Handler object storing the property<br>
<i>propertyKey</i>: the key of the property (string)
</p>

<pre><code class="language-javascript">// get the last level saved to a Module Property with the name currentLevel of this Executable
var currentLevel = dbUtils.getModuleProperty(this, 'currentLevel');
</code></pre>

<hr>

<p><b class="red">setSessionProperty(element, propertyKey, propertyValue)</b> - (no return value)</p>
<p>Used to store unique string values on session level in order to allow access from different parts of the Module or to save values that are specific to a session.</p>

<p><b>Parameters</b><br>
<i>element</i>: the object this property belongs to. Usually the Executable or Handler object storing the property<br>
<i>propertyKey</i>: the key of the property (string)<br>
<i>propertyValue</i>: the value of the property (string)
</p>

<pre><code class="language-javascript">// store the current level as a Session Property with the name currentLevel of this Executable
dbUtils.setSessionProperty(this, 'currentLevel', 4);
</code></pre>

<hr>

<p><b class="red">getSessionProperty(element, propertyKey)</b> - returns the session property value as a string</p>
<p>Used to access a Session Property of a specific element.</p>

<p><b>Parameters</b><br>
<i>element</i>: the object this property belongs to. Usually the Executable or Handler object storing the property<br>
<i>propertyKey</i>: the key of the property (string)
</p>

<pre><code class="language-javascript">// get the last level saved to a Session Property with the name currentLevel of this Executable
var currentLevel = dbUtils.getSessionProperty(this, 'currentLevel');
</code></pre>




<hr>

<h4 id="trial">Trial Methods<span class="pull-right"><a href ng-click="scrollTo('top')"><i class="fa fa-caret-up fa-lg"></i></a></span></h4>

<hr>

<p><b class="red">saveTrial(trial, showStatusFeedback)</b> - returns the trial object that has been saved</p>
<p>Saves a trial object to the database. A trial object represents one line in your data export.</p>

<p><b>Parameters</b><br>
<i>trial</i>: the trial object that should be saved to the database<br>
<i>showStatusFeedback</i>: boolean value indicating whether the feedback status panel should be updated (<b>default: true</b>)</p>

<pre><code class="language-javascript">// create new trial object
var trial = {};
trial.stimulusValue = 'A';
trial.correcResponse = 'B';
trial.givenResponse = 'C';
trial.score = 0;

// save the trial and stop the executable when done
dbUtils.saveTrial(trial).then(executableUtils.stop);
</code></pre>

<hr>
